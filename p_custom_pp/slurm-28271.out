got current job name=pcs5
new job name=pcs6
new job created with id: 28273
staring prediction
Requirement already satisfied: torch in /home/u131168/.local/lib/python3.10/site-packages (2.0.1)
Requirement already satisfied: nvidia-curand-cu11==10.2.10.91 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (10.2.10.91)
Requirement already satisfied: nvidia-nvtx-cu11==11.7.91 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (11.7.91)
Requirement already satisfied: filelock in /home/u131168/.local/lib/python3.10/site-packages (from torch) (3.12.4)
Requirement already satisfied: networkx in /home/u131168/.local/lib/python3.10/site-packages (from torch) (3.1)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (11.7.99)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (8.5.0.96)
Requirement already satisfied: triton==2.0.0 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (2.0.0)
Requirement already satisfied: nvidia-cuda-cupti-cu11==11.7.101 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (11.7.101)
Requirement already satisfied: nvidia-cufft-cu11==10.9.0.58 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (10.9.0.58)
Requirement already satisfied: jinja2 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (3.1.2)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (11.10.3.66)
Requirement already satisfied: nvidia-cusolver-cu11==11.4.0.1 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (11.4.0.1)
Requirement already satisfied: nvidia-cusparse-cu11==11.7.4.91 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (11.7.4.91)
Requirement already satisfied: nvidia-nccl-cu11==2.14.3 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (2.14.3)
Requirement already satisfied: typing-extensions in /home/u131168/.local/lib/python3.10/site-packages (from torch) (4.8.0)
Requirement already satisfied: sympy in /home/u131168/.local/lib/python3.10/site-packages (from torch) (1.12)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /home/u131168/.local/lib/python3.10/site-packages (from torch) (11.7.99)
Requirement already satisfied: wheel in /opt/miniconda/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch) (0.38.4)
Requirement already satisfied: setuptools in /opt/miniconda/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch) (65.6.3)
Requirement already satisfied: lit in /home/u131168/.local/lib/python3.10/site-packages (from triton==2.0.0->torch) (16.0.6)
Requirement already satisfied: cmake in /home/u131168/.local/lib/python3.10/site-packages (from triton==2.0.0->torch) (3.27.5)
Requirement already satisfied: MarkupSafe>=2.0 in /home/u131168/.local/lib/python3.10/site-packages (from jinja2->torch) (2.1.3)
Requirement already satisfied: mpmath>=0.19 in /home/u131168/.local/lib/python3.10/site-packages (from sympy->torch) (1.3.0)
Requirement already satisfied: transformers in /opt/miniconda/lib/python3.10/site-packages (4.35.0.dev0)
Requirement already satisfied: numpy>=1.17 in /home/u131168/.local/lib/python3.10/site-packages (from transformers) (1.26.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.16.4 in /home/u131168/.local/lib/python3.10/site-packages (from transformers) (0.16.4)
Requirement already satisfied: requests in /opt/miniconda/lib/python3.10/site-packages (from transformers) (2.28.1)
Requirement already satisfied: packaging>=20.0 in /opt/miniconda/lib/python3.10/site-packages (from transformers) (23.0)
Requirement already satisfied: regex!=2019.12.17 in /home/u131168/.local/lib/python3.10/site-packages (from transformers) (2023.8.8)
Requirement already satisfied: safetensors>=0.3.1 in /home/u131168/.local/lib/python3.10/site-packages (from transformers) (0.3.3)
Requirement already satisfied: tqdm>=4.27 in /opt/miniconda/lib/python3.10/site-packages (from transformers) (4.65.0)
Requirement already satisfied: filelock in /home/u131168/.local/lib/python3.10/site-packages (from transformers) (3.12.4)
Requirement already satisfied: pyyaml>=5.1 in /home/u131168/.local/lib/python3.10/site-packages (from transformers) (6.0.1)
Requirement already satisfied: tokenizers<0.15,>=0.14 in /home/u131168/.local/lib/python3.10/site-packages (from transformers) (0.14.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /home/u131168/.local/lib/python3.10/site-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (4.8.0)
Requirement already satisfied: fsspec in /home/u131168/.local/lib/python3.10/site-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (2023.6.0)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers) (1.26.15)
Requirement already satisfied: idna<4,>=2.5 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers) (3.4)
Requirement already satisfied: charset-normalizer<3,>=2 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers) (2.0.4)
Requirement already satisfied: certifi>=2017.4.17 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers) (2023.5.7)
Requirement already satisfied: peft in /home/u131168/.local/lib/python3.10/site-packages (0.5.0)
Requirement already satisfied: accelerate in /home/u131168/.local/lib/python3.10/site-packages (from peft) (0.23.0)
Requirement already satisfied: numpy>=1.17 in /home/u131168/.local/lib/python3.10/site-packages (from peft) (1.26.0)
Requirement already satisfied: psutil in /home/u131168/.local/lib/python3.10/site-packages (from peft) (5.9.5)
Requirement already satisfied: pyyaml in /home/u131168/.local/lib/python3.10/site-packages (from peft) (6.0.1)
Requirement already satisfied: tqdm in /opt/miniconda/lib/python3.10/site-packages (from peft) (4.65.0)
Requirement already satisfied: transformers in /opt/miniconda/lib/python3.10/site-packages (from peft) (4.35.0.dev0)
Requirement already satisfied: safetensors in /home/u131168/.local/lib/python3.10/site-packages (from peft) (0.3.3)
Requirement already satisfied: packaging>=20.0 in /opt/miniconda/lib/python3.10/site-packages (from peft) (23.0)
Requirement already satisfied: torch>=1.13.0 in /home/u131168/.local/lib/python3.10/site-packages (from peft) (2.0.1)
Requirement already satisfied: filelock in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (3.12.4)
Requirement already satisfied: sympy in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (1.12)
Requirement already satisfied: jinja2 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (3.1.2)
Requirement already satisfied: nvidia-nvtx-cu11==11.7.91 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (11.7.91)
Requirement already satisfied: triton==2.0.0 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (2.0.0)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (8.5.0.96)
Requirement already satisfied: nvidia-cusolver-cu11==11.4.0.1 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (11.4.0.1)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (11.10.3.66)
Requirement already satisfied: networkx in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (3.1)
Requirement already satisfied: nvidia-curand-cu11==10.2.10.91 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (10.2.10.91)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (11.7.99)
Requirement already satisfied: nvidia-cusparse-cu11==11.7.4.91 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (11.7.4.91)
Requirement already satisfied: typing-extensions in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (4.8.0)
Requirement already satisfied: nvidia-cufft-cu11==10.9.0.58 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (10.9.0.58)
Requirement already satisfied: nvidia-nccl-cu11==2.14.3 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (2.14.3)
Requirement already satisfied: nvidia-cuda-cupti-cu11==11.7.101 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (11.7.101)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /home/u131168/.local/lib/python3.10/site-packages (from torch>=1.13.0->peft) (11.7.99)
Requirement already satisfied: wheel in /opt/miniconda/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch>=1.13.0->peft) (0.38.4)
Requirement already satisfied: setuptools in /opt/miniconda/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch>=1.13.0->peft) (65.6.3)
Requirement already satisfied: cmake in /home/u131168/.local/lib/python3.10/site-packages (from triton==2.0.0->torch>=1.13.0->peft) (3.27.5)
Requirement already satisfied: lit in /home/u131168/.local/lib/python3.10/site-packages (from triton==2.0.0->torch>=1.13.0->peft) (16.0.6)
Requirement already satisfied: huggingface-hub in /home/u131168/.local/lib/python3.10/site-packages (from accelerate->peft) (0.16.4)
Requirement already satisfied: tokenizers<0.15,>=0.14 in /home/u131168/.local/lib/python3.10/site-packages (from transformers->peft) (0.14.0)
Requirement already satisfied: requests in /opt/miniconda/lib/python3.10/site-packages (from transformers->peft) (2.28.1)
Requirement already satisfied: regex!=2019.12.17 in /home/u131168/.local/lib/python3.10/site-packages (from transformers->peft) (2023.8.8)
Requirement already satisfied: fsspec in /home/u131168/.local/lib/python3.10/site-packages (from huggingface-hub->accelerate->peft) (2023.6.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/u131168/.local/lib/python3.10/site-packages (from jinja2->torch>=1.13.0->peft) (2.1.3)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers->peft) (1.26.15)
Requirement already satisfied: idna<4,>=2.5 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers->peft) (3.4)
Requirement already satisfied: certifi>=2017.4.17 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers->peft) (2023.5.7)
Requirement already satisfied: charset-normalizer<3,>=2 in /opt/miniconda/lib/python3.10/site-packages (from requests->transformers->peft) (2.0.4)
Requirement already satisfied: mpmath>=0.19 in /home/u131168/.local/lib/python3.10/site-packages (from sympy->torch>=1.13.0->peft) (1.3.0)
/opt/miniconda/lib/python3.10/site-packages/bitsandbytes/cextension.py:34: UserWarning: The installed version of bitsandbytes was compiled without GPU support. 8-bit optimizers, 8-bit multiplication, and GPU quantization are unavailable.
  warn("The installed version of bitsandbytes was compiled without GPU support. "
b'1907\n'
---------------got start index============1908
/opt/miniconda/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cpu.so: undefined symbol: cadam32bit_grad_fp32
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:47<00:47, 47.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:58<00:00, 26.28s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:58<00:00, 29.41s/it]
predicting 1908 to 1908 prompt
Traceback (most recent call last):
  File "/home/u131168/mh_shell/p_custom_pp/p_custom.py", line 93, in <module>
    input_ids = tokenizer(prompts, return_tensors="pt" ,padding=True,truncation=True, max_length=512).input_ids
  File "/opt/miniconda/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2806, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/opt/miniconda/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2892, in _call_one
    return self.batch_encode_plus(
  File "/opt/miniconda/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3083, in batch_encode_plus
    return self._batch_encode_plus(
  File "/opt/miniconda/lib/python3.10/site-packages/transformers/tokenization_utils_fast.py", line 505, in _batch_encode_plus
    for key in tokens_and_encodings[0][0].keys():
IndexError: list index out of range
finished precition
